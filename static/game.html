<!DOCTYPE html>
<html>
  	<head>
    		<meta charset="utf-8"/>
    		<title>Interface Game Page</title>
    		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js"></script>
		<link rel="stylesheet" type="text/css" href="fiche.css"/>
  	</head>
  	<body style="background-image: url(http://img.fac.pmdstatic.net/fit/http.3A.2F.2Fwww.2Efemmeactuelle.2Efr.2Fvar.2Ffemmeactuelle.2Fstorage.2Fimages.2Fcuisine.2Frecettes.2Fboisson.2Flimonade-au-citron-vert-09024.2F14043909-1-fre-FR.2Flimonade-au-citron-vert.2Ejpg/1200x600/crop-from/center/limonade-au-citron-vert.jpeg); background-size: 100%;">
   	<div style="background:url('https://pub.be/wp-content/uploads/2016/02/LIMO-citron.png') no-repeat; padding:3px; border:8px ridge #F7FF3C; background-color:#000000; max-width: 600px; Opacity: 1;">
	<fieldset>
      		<legend><strong>Nouvelles données</strong></legend> <!-- Titre du fieldset -->
        	<br><label for="text">Production limonades </label>
        	<input type="text" name="production" id="production" />
            	<br><br><label for="name">Prix limonades </label>
            	<input type="text" name="prix" id="prix" />
            	<br><br><button value="Decision" id="action">Envoyer au serveur</button>
  	</fieldset></div>

    	<div style="background:url('http://en.grand-marnier.com/assets/en/cocktails/cocktails_withgrandmojito.jpg') no-repeat; padding:3px; border:8px ridge #F7FF3C; background-color:#000000; max-width: 600px; Opacity: 1;">
	<fieldset>
    		<legend><strong>Données joueur</strong></legend> <!-- Titre du fieldset --> 
          		<br><label for="Pseudo">Pseudo :</label>
          		<input type="text" name="pseudo" id="pseudo" value="{{ username }}" readonly/>
          		<br><br><label for="Stock">Stock :</label>
          		<input type="text" name="stock" id="stock" readonly/>
          		<br><br><label for="Limo">Prix limonades :</label>
          		<input type="text" name="limo" id="limo" value="{{ prix }}" readonly/>
  	</fieldset></div>
    	<div style="background:url('http://www.landi.ch/weather/Content/Wetter/43_real.png') no-repeat; padding:3px; border:8px ridge #F7FF3C; background-color:#000000; max-width: 600px; Opacity: 1;">
	<fieldset>
    		<legend><strong>Données environnement</strong></legend> <!-- Titre du fieldset --> 
          		<br><label for="Meteo">Météo :</label>
          		<input type="text" name="meteo" id="meteo" readonly/>
          		<br><br><label for="Jour">Jour :</label>
          		<input type="text" name="jour" id="jour" readonly/>
          	<br><br><button id="refresh">Rafraichir</button>
  	</fieldset></div>
	<script type="text/javascript"> // Sending message to server
		var dt;
		$( document ).ready(function(){
			alert("Ready !");
			var cook = document.cookie;
			dt = JSON.parse(cook);
			$.get("/map/"+dt.name, function(data, status){
		        	alert("Data: " + data + "\nStatus: " + status);
    			});
			/*$.ajax({
				url: "/map/"+dt.name,
				type: "GET",
				dataType :"json",
				contentType: "application/json; charset=utf-8",
				success: function(response){	
					alert("GET DONE");
					//var data = JSON.parse(response);
					//$('#ventes').val(data.ventes);
					//$('#pseudo').val(data.name);
				},
				failure: function(error){
					alert(error);
				}
    			});*/
		});
        	$("#action").click(function(event){
			event.preventDefault();
			var cook = document.cookie;
			var dat = JSON.parse(cook);
			//A finir
			$.post("/actions/"+dt.name,
    			{
				action:[
				   {
				   cash:1,
				   sales:1,
				   profit:0.0,
				   drinksOffered:{
				   	name:name,
				   	price:0.0,
				   	hasAlcohol:1,
				   	isCold:1}
				   }],
				   	simulated:1}
    			},
    			function(data, status){
        			alert("Data: " + data + "\nStatus: " + status);
    			});
			/*$.ajax({
				url: "/actions/"+dt.name, // route actions
				type: "POST", // Envoyer
				dataType :"json", // format json
				data: JSON.stringify(toSend),
				contentType: "application/json; charset=utf-8",
				success: function(response){ // succès
					alert("POST");
					//var dat = JSON.parse(response); // réponse au format json
					//alert(dat.totalcost);
					//alert(dat.prodLimo);
					//$('#stock').val(dat.prodLimo); // dans stock on demande la valeur de prodLimo
					//$('#limo').val(dat.prixLimo); // dans prix on demande la valeur de prixLimo
					//document.cookie = response;
				},
				failure: function(error){
					alert(error);
				}
    			});
		});*/
    	</script>
	</body>
</html>
